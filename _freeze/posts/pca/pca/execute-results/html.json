{
  "hash": "e8ae7c5cdc03460095ee8572ed50b3c1",
  "result": {
    "markdown": "---\ntitle: \"Trends between Democrats and Republicans\"\nauthor: \"Data Wizards\"\ndate: \"2023-3-31\"\ncategories: ['politics','visualization','statistics','python']\nimage: \"pca.png\"\nformat:\n  html:\n    code-fold: true\n---\n\n\nWhen we talk about Republicans and Democrats, it's important to remember just how many more people are unaffiliated, and how many more don't even register. Yes, there are more Republicans than Democrats, but a well-organized campaign in specific areas can reach a lot of people and have a big sway on the total votes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.3     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.3     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(arrow)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'arrow'\n\nThe following object is masked from 'package:lubridate':\n\n    duration\n\nThe following object is masked from 'package:utils':\n\n    timestamp\n```\n:::\n\n```{.r .cell-code}\nvote <- read_parquet('../../../SWVF_1_full.parquet') %>%\n  mutate(age = 2023 - year(as_datetime(date_of_birth)),\n         age_range = case_when(age <= 25 ~ '18-25',\n                               age <= 40 ~ '26-40',\n                               age <= 64 ~ '40-64',\n                               age > 64 ~ '65+'))\nvote[vote==''] <- ' '\ntotal_pop <- 11756058*.728\nsummary <- vote %>%\n  group_by(party_affiliation) %>%\n  summarise(count=n())\nunregistered <- total_pop - sum(summary$count)\nsummary <- summary %>%\n  add_row(party_affiliation = 'Unregistered', count=unregistered)\n\nggplot(summary,aes(y=reorder(party_affiliation,count),\n                   x=count,\n                   fill=party_affiliation,\n                   label=paste(round(count/total_pop,2)*100),'%'))+\n  geom_col() +\n  theme_minimal() +\n  geom_text(nudge_x=90000) +\n  scale_fill_manual(values=c('R'='red','D'='blue','L'='yellow',' '='purple'),na.value = 'grey')+\n  theme(legend.position='none',\n        panel.grid.minor = element_blank()) +\n  scale_x_continuous(breaks=c(500000,1000000,5000000),labels=c('500','1,000','5,000')) +\n  labs(x='Total Voters (in thousands)',y='Party',title='Most People Haven\\'t Registered')\n```\n\n::: {.cell-output-display}\n![](pca_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\nMost national trends apply to Ohio too. People turn more conservative as they get older, younger people are less likely to register to vote, etc.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nage_sum <- vote %>%\n  group_by(age_range,party_affiliation) %>%\n  summarise(count = n())\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'age_range'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nage_sum$party_affiliation <- replace(age_sum$party_affiliation,values=c(' '='Unaffiliated','D'='Democrat','L'='Libertarian','R'='Republican'))\nparty_order <- c(\"Unaffiliated\", \"Republican\", \"Democrat\", \"Libertarian\")\n\n# Set the Party variable as a factor with the desired order\nage_sum$party_affiliation <- factor(age_sum$party_affiliation, levels = party_order)\nf= ggplot(age_sum, aes(x=age_range,y=count,fill=party_affiliation,label=count)) +\n  geom_col(position='dodge') +\n  scale_fill_manual(values=c('Republican'='red','Democrat'='blue','Libertarian'='yellow','Unaffiliated'='purple'),na.value = 'grey') +\n  theme_minimal() +\n  scale_y_continuous(breaks=c(100000,250000,500000),\n                     labels=c('100,000','250,000','500,000')) +\n  labs(y='Number of Voters',x='Age Range',title='Affiliation by Age Range',\n       fill='Party Affiliation')\nf %>% plotly::ggplotly()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-e5b2ad467dbb77862873\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-e5b2ad467dbb77862873\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.22500000000000009,0.22500000000000009,0.22500000000000053,0.22500000000000053],\"base\":[0,0,0,0],\"x\":[0.66250000000000009,1.6625000000000001,2.6625000000000001,3.6625000000000001],\"y\":[185981,462951,578103,253305],\"text\":[\"age_range: 18-25<br />count: 185981<br />party_affiliation: Unaffiliated<br />count: 185981\",\"age_range: 26-40<br />count: 462951<br />party_affiliation: Unaffiliated<br />count: 462951\",\"age_range: 40-64<br />count: 578103<br />party_affiliation: Unaffiliated<br />count: 578103\",\"age_range: 65+<br />count: 253305<br />party_affiliation: Unaffiliated<br />count: 253305\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(160,32,240,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Unaffiliated\",\"legendgroup\":\"Unaffiliated\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.22500000000000009,0.22500000000000009,0.22499999999999964,0.22499999999999964],\"base\":[0,0,0,0],\"x\":[0.88749999999999996,1.8875,2.8875000000000002,3.8875000000000002],\"y\":[9464,29996,143528,170922],\"text\":[\"age_range: 18-25<br />count:   9464<br />party_affiliation: Republican<br />count:   9464\",\"age_range: 26-40<br />count:  29996<br />party_affiliation: Republican<br />count:  29996\",\"age_range: 40-64<br />count: 143528<br />party_affiliation: Republican<br />count: 143528\",\"age_range: 65+<br />count: 170922<br />party_affiliation: Republican<br />count: 170922\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,0,0,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Republican\",\"legendgroup\":\"Republican\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.22500000000000009,0.22499999999999987,0.22499999999999964,0.22499999999999964],\"base\":[0,0,0,0],\"x\":[1.1125,2.1124999999999998,3.1124999999999998,4.1124999999999998],\"y\":[11967,39598,100836,139364],\"text\":[\"age_range: 18-25<br />count:  11967<br />party_affiliation: Democrat<br />count:  11967\",\"age_range: 26-40<br />count:  39598<br />party_affiliation: Democrat<br />count:  39598\",\"age_range: 40-64<br />count: 100836<br />party_affiliation: Democrat<br />count: 100836\",\"age_range: 65+<br />count: 139364<br />party_affiliation: Democrat<br />count: 139364\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,0,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Democrat\",\"legendgroup\":\"Democrat\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.22500000000000009,0.22499999999999964,0.22500000000000053,0.22499999999999964],\"base\":[0,0,0,0],\"x\":[1.3374999999999999,2.3374999999999999,3.3374999999999999,4.3375000000000004],\"y\":[16,89,136,70],\"text\":[\"age_range: 18-25<br />count:     16<br />party_affiliation: Libertarian<br />count:     16\",\"age_range: 26-40<br />count:     89<br />party_affiliation: Libertarian<br />count:     89\",\"age_range: 40-64<br />count:    136<br />party_affiliation: Libertarian<br />count:    136\",\"age_range: 65+<br />count:     70<br />party_affiliation: Libertarian<br />count:     70\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,255,0,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Libertarian\",\"legendgroup\":\"Libertarian\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826491,\"l\":66.484018264840202},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Affiliation by Age Range\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,4.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"18-25\",\"26-40\",\"40-64\",\"65+\"],\"tickvals\":[1,2,3,4],\"categoryorder\":\"array\",\"categoryarray\":[\"18-25\",\"26-40\",\"40-64\",\"65+\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Age Range\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-28905.150000000001,607008.15000000002],\"tickmode\":\"array\",\"ticktext\":[\"100,000\",\"250,000\",\"500,000\"],\"tickvals\":[100000,250000.00000000003,500000],\"categoryorder\":\"array\",\"categoryarray\":[\"100,000\",\"250,000\",\"500,000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Number of Voters\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Party Affiliation\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"653431bf5ba7\":{\"x\":{},\"y\":{},\"fill\":{},\"label\":{},\"type\":\"bar\"}},\"cur_data\":\"653431bf5ba7\",\"visdat\":{\"653431bf5ba7\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nIf you want to see the full official registration, use the county breakdown below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DT)\ncodes <- read_csv('../../County Codes.csv')\ncounty  <- vote %>% \n  filter(age < 100) %>%\n  group_by(party_affiliation,county_number) %>%\n  summarise(count=n()) %>%\n  mutate(county = codes$County[county_number]) %>%\n  select(county,party_affiliation,count) %>%\n  pivot_wider(names_from=party_affiliation,values_from=count)\n#colnames(county) <- c('County','Democrats','Republicans','Libertarian','Unaffiliated')\ndatatable(county)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-fb164e56ba41524abdde\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-fb164e56ba41524abdde\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\"],[\"Adams County\",\"Allen County\",\"Ashland County\",\"Ashtabula County\",\"Athens County\",\"Auglaize County\",\"Belmont County\",\"Brown County\",\"Butler County\",\"Carroll County\",\"Champaign County\",\"Clark County\",\"Clermont County\",\"Clinton County\",\"Columbiana County\",\"Coshocton County\",\"Crawford County\",\"Cuyahoga County\",\"Darke County\",\"Defiance County\",\"Delaware County\",\"Erie County\"],[11664,44320,22513,41676,26628,20921,30432,21032,179998,11897,16955,59421,101905,17618,44877,12775,18341,616407,20956,17112,104753,37381],[914,5040,2258,7283,6731,1480,4800,1740,18349,1474,1896,8972,10859,1195,5408,1779,1811,178857,1798,2306,19394,7210],[null,16,6,21,4,17,5,null,null,null,9,null,null,8,null,9,11,122,null,7,67,9],[4513,16193,9626,11134,4028,9704,8496,6124,43898,4653,7411,18028,32321,8329,14284,7402,7351,78895,11443,6692,34678,8589]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>county<\\/th>\\n      <th> <\\/th>\\n      <th>D<\\/th>\\n      <th>L<\\/th>\\n      <th>R<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,5]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nCounties like Athens usually have a large university, while Delaware County have more middle-aged populations. \n\n\n::: {.cell .column-screen-inset-shaded}\n\n```{.r .cell-code}\ncountyage <- vote %>%\n  mutate(county = codes$County[county_number],\n         county = str_replace(county,'County','')) %>%\n  filter(age < 100)\nggplot(countyage,aes(x=age)) +\n  geom_density()+\n  facet_wrap(vars(countyage$county),ncol = 8)+\n  theme_minimal() +\n  labs(title='Demographic Breakdown by County',x='Age',\n       y='Density of Age')\n```\n\n::: {.cell-output-display}\n![](pca_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::",
    "supporting": [
      "pca_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<script src=\"../../site_libs/plotly-binding-4.10.2/plotly.js\"></script>\r\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\r\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\r\n<link href=\"../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\r\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/datatables-binding-0.30/datatables.js\"></script>\r\n<link href=\"../../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\r\n<link href=\"../../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}