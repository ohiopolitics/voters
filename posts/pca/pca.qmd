---
title: "Trends between Democrats and Republicans"
author: "Data Wizards"
date: "2023-3-31"
categories: ['politics','visualization','statistics','python']
image: "pca.png"
format:
  html:
    code-fold: true
---

When we talk about Republicans and Democrats, it's important to remember just how many more people are unaffiliated, and how many more don't even register. Yes, there are more Republicans than Democrats, but a well-organized campaign in specific areas can reach a lot of people and have a big sway on the total votes.

```{r}
library(tidyverse)
library(arrow)
vote <- read_parquet('../../../SWVF_1_full.parquet')
total_pop <- 11756058*.728
summary <- vote %>%
  group_by(party_affiliation) %>%
  summarise(count=n())
unregistered <- total_pop - sum(summary$count)
summary <- summary %>%
  add_row(party_affiliation = 'Unregistered', count=unregistered)
summary$party_affiliation <- c('Unaffiliated','Democrat','Libertarian','Republican','Unregistered')


ggplot(summary,aes(y=reorder(party_affiliation,count),
                   x=count,
                   fill=party_affiliation,
                   label=paste(round(count/total_pop,2)*100),'%'))+
  geom_col() +
  theme_minimal() +
  geom_text(nudge_x=90000) +
  scale_fill_manual(values=c('Republican'='red','Democrat'='blue','Libertarian'='yellow','Unaffiliated'='purple'),na.value = 'grey')+
  theme(legend.position='none',
        panel.grid.minor = element_blank()) +
  scale_x_continuous(breaks=c(500000,1000000,5000000),labels=c('500','1,000','5,000')) +
  labs(x='Total Voters (in thousands)',y='Party',title='Most People Haven\'t Registered')
```

Most national trends apply to Ohio too. People turn more conservative as they get older, younger people are less likely to register to vote, etc.

```{r}
vote$age = 2023 - year(as_datetime(vote$date_of_birth))

vote <- vote %>% 
  mutate(age_range = case_when(age <= 25 ~ '18-25',
                               age <= 40 ~ '26-40',
                               age <= 64 ~ '40-64',
                               age > 64 ~ '65+'))

age_sum <- vote %>%
  group_by(age_range,party_affiliation) %>%
  summarise(count = n())

f= ggplot(age_sum, aes(x=age_range,y=count,fill=party_affiliation)) +
  geom_col(position='dodge')

f %>% plotly::ggplotly()
```

If you want to see the full official registration, use the county breakdown below.

```{r,message=FALSE}
library(DT)
codes <- read_csv('../../County Codes.csv')
county  <- vote %>% 
  group_by(party_affiliation,county_number) %>%
  summarise(count=n()) %>%
  mutate(county = codes$County[county_number]) %>%
  select(county,party_affiliation,count) %>%
  pivot_wider(names_from=party_affiliation,values_from=count)
colnames(county) <- c('County','Democrats','Republicans','Libertarian','Unaffiliated')
datatable(county)
```